<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8B4513">
    <title>‚òï Espresso Tracker</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f8f5f0;
            padding: 0;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #8B4513 0%, #6B3410 100%);
            color: white;
            padding: 25px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
        }
        
        .tab {
            padding: 15px 35px;
            background: white;
            border: 2px solid #e0d5c7;
            border-radius: 12px;
            cursor: pointer;
            font-size: 17px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .tab:hover {
            border-color: #8B4513;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.15);
        }
        
        .tab.active {
            background: linear-gradient(135deg, #8B4513 0%, #6B3410 100%);
            color: white;
            border-color: #8B4513;
        }
        
        .section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        h2 {
            color: #8B4513;
            font-size: 24px;
            margin-bottom: 25px;
            font-weight: 700;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 15px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0d5c7;
            border-radius: 10px;
            font-size: 16px;
            background: #fafaf8;
            transition: all 0.2s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #8B4513;
            background: white;
            box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
        }
        
        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #8B4513 0%, #6B3410 100%);
            color: white;
            width: 100%;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }
        
        .btn-secondary {
            background: #f0e6d9;
            color: #8B4513;
            font-weight: 600;
            padding: 12px 24px;
            font-size: 15px;
        }
        
        .btn-small {
            padding: 10px 20px;
            font-size: 14px;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .shot-item {
            background: #fafaf8;
            border: 2px solid #e8ddd0;
            border-radius: 14px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .shot-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #8B4513;
        }
        
        .shot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8ddd0;
        }
        
        .shot-title {
            font-size: 20px;
            font-weight: 700;
            color: #8B4513;
        }
        
        .shot-date {
            font-size: 14px;
            color: #888;
            margin-top: 5px;
        }
        
        .shot-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 18px;
            margin-top: 15px;
        }
        
        .detail {
            background: white;
            padding: 14px;
            border-radius: 10px;
            font-size: 15px;
            color: #555;
        }
        
        .detail strong {
            color: #8B4513;
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }
        
        .bag-item {
            background: #fafaf8;
            border: 2px solid #e8ddd0;
            border-radius: 14px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .bag-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .bag-title {
            font-size: 20px;
            font-weight: 700;
            color: #8B4513;
        }
        
        .bag-info {
            margin-top: 12px;
            font-size: 15px;
            color: #666;
            line-height: 1.6;
        }
        
        .bag-status {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            margin-top: 10px;
        }
        
        .bag-status.active {
            background: #4caf50;
            color: white;
        }
        
        .bag-status.finished {
            background: #9e9e9e;
            color: white;
        }
        
        .alert {
            padding: 18px 22px;
            border-radius: 12px;
            margin-bottom: 25px;
            font-weight: 500;
            font-size: 15px;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 5px solid #28a745;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 5px solid #dc3545;
        }
        
        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }
        
        .file-input-wrapper input[type=file] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }
        
        @media (max-width: 600px) {
            .row { grid-template-columns: 1fr; }
            .container { padding: 20px 15px; }
            .tabs { flex-direction: column; gap: 10px; }
            .tab { padding: 12px 20px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚òï Espresso Tracker</h1>
    </div>
    
    <div id="root">
        <div class="container">
            <div style="text-align: center; padding: 60px 20px; color: #8B4513;">
                <h2>‚è≥ Chargement...</h2>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script>
        window.addEventListener('load', function() {
            if (!window.supabase) {
                document.getElementById('root').innerHTML = '<div class="container"><div class="alert alert-error">‚ùå Erreur de chargement</div></div>';
                return;
            }
            
            const { useState, useEffect } = React;
            const { createClient } = window.supabase;

            const supabase = createClient(
                'https://duzxzqmjkovrsfwhdyml.supabase.co',
                'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR1enh6cW1qa292cnNmd2hkeW1sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3NjAzMzYsImV4cCI6MjA4NjMzNjMzNn0.hRUDEbr9yhd_R1Q0lLVYYppnht5tUAd5TtE9kanzvos'
            );

            const LOGOS = {
                timana: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACbUlEQVR4nO2bPVLDMBSEVxnOkQ5OQUtDTkBNmYaOM9DRUKbmBlSUnIKSjlOYgiiRZcnSk/WzzmgbMkNG8n5vnyx7IoW6GgTfVcWuouIkEsMhFbnWEoN6TQ/vN9GDqIfv2X8Lrmd+nlwDwWFcYjgkD5DF158DQFHjtnKDWArgZL6kaZ8sGEleUgGMqt7CvJYjESJPKQDOVd8f/j/cviQMk1epadgI55maB4CvZ+Ew+WWlMPr2KwHgNk+kFAixAMLmCVIAyCHEAIiv/AohhADQx96nWAhzANLMk6QAiIMQbIG1Vd5WaI/iAzAAC8wTpQAYQZikwAUgzyMsGQRDI3/eFlh79G35WsEGsCz6tshS4GoF6Vb44mQCyPn66iyyFBgaAEcCLq33bdlrQZ0W4E3B6bk57+LnE8F7Ay39/qAvglVnI2yFngDU6n8tkhTou0FPQJNZSVIAtEwACYTeAk1nJ0jBVesL2P1+Npx921ugKYDd9V3L6QE0BMBgHmi9CBJog+MjsXp7rDYpQ/U/nrYAegLqA2CovqmegOPfKusAS/V1/wNQ1RLAYt7WBEDNu0ELGdUHMAZQ7HfDpNVXQF8EJwCyL4ZM1TcXP/3Bm4BLWwvs3tdyAci2FjBV39DIny8Bi1uBybwr+lrBRXDtreCLvtYcgBMtKQSW6lvmna0dSkAyhNaKMQ/E7QNEEBiqH2seiN8IRUFYm3lAthOkbwepeUC+FfZCaF39FPOiL1oanxnaH5oBcNzmRJ5SH4YUCFrCUXVxQYucG7x//ckwrFuejU2zc4OmioLIbTzbAA55f3EqARLYwlKeHXaJ/vT4H4+IseLBtt/JAAAAAElFTkSuQmCC',
                gedeo: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACcUlEQVR4nO2bvU7DMBSFTyo2dgZmNhaeAYmZHfYO3XkKdiTYeQDmCt6CjZWFvXNY6shx7NjX8c9J5bNQidbO+e65jhMlHcqqF3y3y3YUBSeRGPYpy7HmGNRp+vb9EDzI1+P53L+THXdKABPjEsM+OYAsPv4UALIaN5UaxFIAg/mcpl0yYER5iQUwqnoN80qWRIg8xQAYzG/3OwDAz99zxDBpFZuGjXCeiXkAuLp4Eg6TXkYKg0+/EgBW80yKgRAKwGueIQWAHEIIgODKrxGCDwB97F0KhTAHIMo8SwqAMAjeFlhb5U359iguAD0Qb54pBcAIwiQFNgBJLmHZIGga+XO2wNqjb8rVCiaARdE3xZYCWytIt8InJx1AyttXg9hSoKkHLAk4td43Za4FRVqAOAXDdXPSxc8lhvsGSur+QVsES07G2AotASjU/0osKVBng5aAGpOypAComAAWCK0Fak7OkIKz2gfwefNQbe4OrQXqAni9/K05PYCKABjMA60FsMHxkvjt7qXYpAzV764/ALQElAfAUH1dLQHHv0XWAZbqq/4H0BVLAIt5UxMAJc8GNaRVH8AYQLbnhkmr3wFtEZwASL4YMlVfX/zUB2cCTm0tMHtfyQYg2VrAVH1NI3+uBCxuBSbztugreRfBtbeCK/pKcwAGWlIILNU3zFtb25eAaAi1FWIeCNsHiCAwVD/UPBC+EQqCsDbzgGwnSN8OUvOAfCvshFC7+jHmRV80NHqibLvfVQNgOc1lf2dI1wCi/75fOJRcsVVf/CNDk+cLc8JwbGyqvTeoKyuI1MaTDWCR84lTCRDPFpby3WGb6N8e/wdHGbWdc2XBIwAAAABJRU5ErkJggg==',
                generic: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACdUlEQVR4nO2bP07DMBjFXypuwYbETTgDExIDOwsLW8XWhYWdoRITZ0Bi4QLMSEyUiTuEpY4cx679Of7zUvktVKK1837f+xwnSjqUVS/4bpftKApOIjHsU5ZjzTGo0/Tb60vwIBeXV4f+ney4UwKYGJcY9skBZPbxpwCQ1bip1CDmAhjM5zTtkgEjykssgFHVa5hXsiRC5CkGwGB+u1kDAE7PziOGSavYNKyE80zMA8Du+0s4THoZKQw+/UoAWM0zKQZCKACveYYUAHIIIQCCK79ECD4A9LF3KRTCIQBR5llSAIRB8LbA0ipvyrdHcQHogXjzTCkARhAmKbABSHIJywZB08ifswWWHn1TrlYwAcyKvim2FNhaQboVPjrpAFLevhrElgJNPWBJwLH1vilzLSjSAsQpGK6bky5+LjHcN1BS9w/aIlhyMsZWaAlAof5XYkmBOhu0BNSYlCUFQMUEsEBoLVBzcoYUnNQ+gM+P96rztxaoOfnf70/N6QFUBMBgHmgtgBX2l8TX9w/FJmWo/t3TM4CWgPIAGKqvqyVg/7fIOsBSfdX/ALpiCWAxb2oCoOTZoIa06gMYA8j23DBp9TugLYITAMkXQ6bq64uf+uBMwLGtBWbvK9kAJFsLmKqvaeTPlYDZrcBk3hZ9Je8iuPRWcEVf6RCAgZYUAkv1DfPW1vYlIBpCbYWYB8L2ASIIDNUPNQ+Eb4SCICzNPCDbCdK3g9Q8IN8KOyHUrn6MedEXDY2eKNtu1tUAWE5z2d8Z0jWAeLy9mTmUXLFVn/0jQ5PnC3PCcGxsqr03qCsriNTGkw1gkfOJUwkQzxaW8t1hm+jfHv8HiQrra/56lPwAAAAASUVORK5CYII='
            };

            function getLogo(name) {
                if (!name) return LOGOS.generic;
                const n = name.toLowerCase();
                if (n.includes('timana') || n.includes('timan√†')) return LOGOS.timana;
                if (n.includes('gedeo') || n.includes('g√©d√©o')) return LOGOS.gedeo;
                return LOGOS.generic;
            }

            function App() {
                const [tab, setTab] = useState('shots');
                const [shots, setShots] = useState([]);
                const [bags, setBags] = useState([]);
                const [msg, setMsg] = useState(null);
                const [formData, setFormData] = useState({
                    coffee: '',
                    bag_id: '',
                    dose: 18,
                    output: 38,
                    grind: 7.5,
                    time: 30,
                    preinfusion: 8,
                    wdt: 'non',
                    channeling: 'non',
                    flow: 'stable',
                    taste: '',
                    notes: ''
                });

                useEffect(() => { load(); }, []);

                async function load() {
                    const { data: s } = await supabase.from('shots').select('*').order('created_at', { ascending: false });
                    const { data: b } = await supabase.from('bags').select('*').order('created_at', { ascending: false });
                    setShots(s || []);
                    setBags(b || []);
                }

                function showMsg(type, text) {
                    setMsg({ type, text });
                    setTimeout(() => setMsg(null), 4000);
                }

                async function addShot(e) {
                    e.preventDefault();
                    
                    const selectedBag = bags.find(b => b.id.toString() === formData.bag_id);
                    const age = selectedBag && selectedBag.roast_date ? 
                        Math.floor((new Date() - new Date(selectedBag.roast_date.split('/').reverse().join('-'))) / 86400000) : 0;
                    
                    const shot = {
                        date: new Date().toLocaleString('fr-FR'),
                        coffee: formData.coffee || (selectedBag ? selectedBag.name : ''),
                        roaster: selectedBag ? selectedBag.roaster : "L'Arbre √† Caf√©",
                        roast_date: selectedBag ? selectedBag.roast_date : '',
                        age,
                        dose: parseFloat(formData.dose),
                        output: parseFloat(formData.output),
                        ratio: parseFloat((formData.output / formData.dose).toFixed(2)),
                        grind: parseFloat(formData.grind),
                        time: parseInt(formData.time),
                        preinfusion: parseInt(formData.preinfusion),
                        wdt: formData.wdt,
                        channeling: formData.channeling,
                        flow: formData.flow,
                        taste: formData.taste,
                        notes: formData.notes
                    };
                    
                    const { data } = await supabase.from('shots').insert([shot]).select();
                    setShots([data[0], ...shots]);
                    showMsg('success', '‚úÖ Shot enregistr√© !');
                    
                    setFormData({
                        coffee: '',
                        bag_id: '',
                        dose: 18,
                        output: 38,
                        grind: 7.5,
                        time: 30,
                        preinfusion: 8,
                        wdt: 'non',
                        channeling: 'non',
                        flow: 'stable',
                        taste: '',
                        notes: ''
                    });
                }

                async function delShot(id) {
                    if (!confirm('Supprimer ?')) return;
                    await supabase.from('shots').delete().eq('id', id);
                    setShots(shots.filter(s => s.id !== id));
                }

                async function addBag(e) {
                    e.preventDefault();
                    const form = e.target;
                    const bag = {
                        name: form.name.value,
                        roaster: form.roaster.value,
                        roast_date: form.roast_date.value,
                        weight: parseInt(form.weight.value),
                        notes: form.notes.value,
                        status: 'active'
                    };
                    const { data } = await supabase.from('bags').insert([bag]).select();
                    setBags([data[0], ...bags]);
                    showMsg('success', '‚úÖ Paquet ajout√© !');
                    form.reset();
                }

                async function toggleBag(id, status) {
                    await supabase.from('bags').update({ status: status === 'active' ? 'finished' : 'active' }).eq('id', id);
                    setBags(bags.map(b => b.id === id ? { ...b, status: status === 'active' ? 'finished' : 'active' } : b));
                }

                async function delBag(id) {
                    if (!confirm('Supprimer ?')) return;
                    await supabase.from('bags').delete().eq('id', id);
                    setBags(bags.filter(b => b.id !== id));
                }

                async function importCSV(e) {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = async (ev) => {
                        try {
                            const lines = ev.target.result.split('\n').filter(l => l.trim());
                            const data = [];
                            for (let i = 1; i < lines.length; i++) {
                                const v = lines[i].split(',');
                                if (v.length < 10) continue;
                                data.push({
                                    date: v[0].trim(),
                                    coffee: v[1].trim(),
                                    roaster: v[2].trim(),
                                    roast_date: v[3].trim(),
                                    age: parseInt(v[4]) || 0,
                                    dose: parseFloat(v[5]) || 18,
                                    output: parseFloat(v[6]) || 36,
                                    ratio: parseFloat(v[7]) || 2,
                                    grind: parseFloat(v[8]) || 7.5,
                                    time: parseInt(v[9]) || 0,
                                    preinfusion: parseInt(v[10]) || 0,
                                    wdt: v[11]?.trim() || 'non',
                                    channeling: v[12]?.trim() || 'non',
                                    flow: v[13]?.trim() || 'stable',
                                    taste: v[14]?.trim() || '',
                                    notes: v[15]?.trim() || ''
                                });
                            }
                            await supabase.from('shots').insert(data);
                            load();
                            showMsg('success', `‚úÖ ${data.length} shots import√©s !`);
                        } catch (e) {
                            showMsg('error', '‚ùå ' + e.message);
                        }
                    };
                    reader.readAsText(file);
                }

                function exportCSV() {
                    const h = ['Date shot','Caf√©','Torr√©facteur','Date torr√©faction','√Çge (jours)','Dose (g)','Sortie (g)','Ratio','Mouture','Temps (s)','Pr√©infusion (s)','WDT','Channeling','D√©bit','Go√ªt','Notes'];
                    const rows = shots.map(s => [s.date,s.coffee,s.roaster,s.roast_date,s.age,s.dose,s.output,s.ratio,s.grind,s.time,s.preinfusion,s.wdt,s.channeling,s.flow,s.taste,s.notes].join(','));
                    const csv = [h.join(','), ...rows].join('\n');
                    const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `espresso_${new Date().toISOString().split('T')[0]}.csv`;
                    link.click();
                }

                const activeBags = bags.filter(b => b.status === 'active');

                return React.createElement('div', { className: 'container' },
                    React.createElement('div', { className: 'tabs' },
                        React.createElement('button', {
                            className: `tab ${tab === 'shots' ? 'active' : ''}`,
                            onClick: () => setTab('shots')
                        }, '‚òï Shots'),
                        React.createElement('button', {
                            className: `tab ${tab === 'bags' ? 'active' : ''}`,
                            onClick: () => setTab('bags')
                        }, 'üì¶ Paquets'),
                        React.createElement('button', {
                            className: `tab ${tab === 'settings' ? 'active' : ''}`,
                            onClick: () => setTab('settings')
                        }, '‚öôÔ∏è Param√®tres')
                    ),

                    msg && React.createElement('div', { className: `alert alert-${msg.type}` }, msg.text),

                    tab === 'shots' && React.createElement('div', null,
                        React.createElement('div', { className: 'section' },
                            React.createElement('h2', null, '+ Nouveau Shot'),
                            React.createElement('form', { onSubmit: addShot },
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Paquet actif'),
                                    React.createElement('select', {
                                        value: formData.bag_id,
                                        onChange: (e) => {
                                            const bag = bags.find(b => b.id.toString() === e.target.value);
                                            setFormData({
                                                ...formData,
                                                bag_id: e.target.value,
                                                coffee: bag ? bag.name : formData.coffee
                                            });
                                        }
                                    },
                                        React.createElement('option', { value: '' }, '-- Choisir un paquet --'),
                                        activeBags.map(b => React.createElement('option', { key: b.id, value: b.id }, `${b.name} (${b.roaster})`))
                                    )
                                ),
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Caf√© (optionnel si paquet s√©lectionn√©)'),
                                    React.createElement('input', {
                                        type: 'text',
                                        placeholder: 'Nom du caf√©',
                                        value: formData.coffee,
                                        onChange: (e) => setFormData({...formData, coffee: e.target.value})
                                    })
                                ),
                                React.createElement('div', { className: 'row' },
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Dose (g)'),
                                        React.createElement('input', {
                                            type: 'number',
                                            step: '0.1',
                                            value: formData.dose,
                                            onChange: (e) => setFormData({...formData, dose: e.target.value}),
                                            required: true
                                        })
                                    ),
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Sortie (g)'),
                                        React.createElement('input', {
                                            type: 'number',
                                            step: '0.1',
                                            value: formData.output,
                                            onChange: (e) => setFormData({...formData, output: e.target.value}),
                                            required: true
                                        })
                                    )
                                ),
                                React.createElement('div', { className: 'row' },
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Mouture'),
                                        React.createElement('input', {
                                            type: 'number',
                                            step: '0.1',
                                            value: formData.grind,
                                            onChange: (e) => setFormData({...formData, grind: e.target.value}),
                                            required: true
                                        })
                                    ),
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Temps (s)'),
                                        React.createElement('input', {
                                            type: 'number',
                                            value: formData.time,
                                            onChange: (e) => setFormData({...formData, time: e.target.value}),
                                            required: true
                                        })
                                    )
                                ),
                                React.createElement('div', { className: 'row' },
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Pr√©infusion (s)'),
                                        React.createElement('input', {
                                            type: 'number',
                                            value: formData.preinfusion,
                                            onChange: (e) => setFormData({...formData, preinfusion: e.target.value})
                                        })
                                    ),
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'WDT'),
                                        React.createElement('select', {
                                            value: formData.wdt,
                                            onChange: (e) => setFormData({...formData, wdt: e.target.value})
                                        },
                                            ['non', 'l√©ger', 'normal', 'profond'].map(o => React.createElement('option', { key: o, value: o }, o.charAt(0).toUpperCase() + o.slice(1)))
                                        )
                                    )
                                ),
                                React.createElement('div', { className: 'row' },
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Channeling'),
                                        React.createElement('select', {
                                            value: formData.channeling,
                                            onChange: (e) => setFormData({...formData, channeling: e.target.value})
                                        },
                                            React.createElement('option', { value: 'non' }, 'Non'),
                                            React.createElement('option', { value: 'oui' }, 'Oui')
                                        )
                                    ),
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'D√©bit'),
                                        React.createElement('select', {
                                            value: formData.flow,
                                            onChange: (e) => setFormData({...formData, flow: e.target.value})
                                        },
                                            ['rapide', 'stable', 'lent'].map(o => React.createElement('option', { key: o, value: o }, o.charAt(0).toUpperCase() + o.slice(1)))
                                        )
                                    )
                                ),
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Go√ªt'),
                                    React.createElement('input', {
                                        type: 'text',
                                        placeholder: 'tr√®s bon, bon, acide...',
                                        value: formData.taste,
                                        onChange: (e) => setFormData({...formData, taste: e.target.value})
                                    })
                                ),
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Notes'),
                                    React.createElement('textarea', {
                                        rows: 3,
                                        placeholder: 'Observations...',
                                        value: formData.notes,
                                        onChange: (e) => setFormData({...formData, notes: e.target.value})
                                    })
                                ),
                                React.createElement('button', { type: 'submit', className: 'btn btn-primary' }, 'Enregistrer le Shot')
                            )
                        ),

                        React.createElement('div', { className: 'section' },
                            React.createElement('h2', null, `üìã Historique (${shots.length} shots)`),
                            shots.length === 0 && React.createElement('p', { style: { textAlign: 'center', color: '#888', padding: '40px' } }, 'Aucun shot enregistr√©'),
                            shots.map(s => React.createElement('div', { key: s.id, className: 'shot-item' },
                                React.createElement('div', { className: 'shot-header' },
                                    React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px' } },
                                        React.createElement('img', {
                                            src: getLogo(s.coffee),
                                            style: { width: '40px', height: '40px', borderRadius: '50%' }
                                        }),
                                        React.createElement('div', null,
                                            React.createElement('div', { className: 'shot-title' }, s.coffee),
                                            React.createElement('div', { className: 'shot-date' }, s.date)
                                        )
                                    ),
                                    React.createElement('button', {
                                        className: 'btn btn-danger btn-small',
                                        onClick: () => delShot(s.id)
                                    }, '‚úï Supprimer')
                                ),
                                React.createElement('div', { className: 'shot-details' },
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'Dose ‚Üí Sortie'),
                                        `${s.dose}g ‚Üí ${s.output}g (1:${s.ratio.toFixed(1)})`
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'Mouture'),
                                        s.grind
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'Temps'),
                                        s.time + 's'
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'Pr√©infusion'),
                                        s.preinfusion + 's'
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, '√Çge'),
                                        s.age + 'j'
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'WDT'),
                                        s.wdt
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'Channeling'),
                                        s.channeling
                                    ),
                                    React.createElement('div', { className: 'detail' },
                                        React.createElement('strong', null, 'Go√ªt'),
                                        s.taste || '-'
                                    )
                                ),
                                s.notes && React.createElement('div', { style: { marginTop: '15px', fontSize: '15px', color: '#666', fontStyle: 'italic' } }, 'üìù ' + s.notes)
                            ))
                        )
                    ),

                    tab === 'bags' && React.createElement('div', null,
                        React.createElement('div', { className: 'section' },
                            React.createElement('h2', null, '+ Nouveau Paquet'),
                            React.createElement('form', { onSubmit: addBag },
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Nom du caf√© *'),
                                    React.createElement('input', { type: 'text', name: 'name', placeholder: 'G√©d√©o, Timan√†...', required: true })
                                ),
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Torr√©facteur'),
                                    React.createElement('input', { type: 'text', name: 'roaster', defaultValue: "L'Arbre √† Caf√©" })
                                ),
                                React.createElement('div', { className: 'row' },
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Date torr√©faction (JJ/MM/AAAA) *'),
                                        React.createElement('input', { type: 'text', name: 'roast_date', placeholder: '31/12/2025', required: true })
                                    ),
                                    React.createElement('div', { className: 'form-group' },
                                        React.createElement('label', null, 'Poids (g)'),
                                        React.createElement('input', { type: 'number', name: 'weight', defaultValue: 250 })
                                    )
                                ),
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', null, 'Notes'),
                                    React.createElement('textarea', { name: 'notes', rows: 3, placeholder: 'Profil aromatique...' })
                                ),
                                React.createElement('button', { type: 'submit', className: 'btn btn-primary' }, 'Ajouter le Paquet')
                            )
                        ),

                        React.createElement('div', { className: 'section' },
                            React.createElement('h2', null, `üì¶ Mes Paquets (${bags.length})`),
                            bags.length === 0 && React.createElement('p', { style: { textAlign: 'center', color: '#888', padding: '40px' } }, 'Aucun paquet enregistr√©'),
                            bags.map(b => {
                                const age = b.roast_date ? Math.floor((new Date() - new Date(b.roast_date.split('/').reverse().join('-'))) / 86400000) : 0;
                                return React.createElement('div', { key: b.id, className: 'bag-item' },
                                    React.createElement('div', { className: 'bag-header' },
                                        React.createElement('div', { style: { display: 'flex', alignItems: 'flex-start', gap: '15px' } },
                                            React.createElement('img', {
                                                src: getLogo(b.name),
                                                style: { width: '50px', height: '50px', borderRadius: '50%', marginTop: '4px' }
                                            }),
                                            React.createElement('div', null,
                                                React.createElement('div', { className: 'bag-title' }, b.name),
                                                React.createElement('div', { className: 'bag-info' },
                                                    `${b.roaster} ‚Ä¢ Torr√©fi√© le ${b.roast_date}`,
                                                    React.createElement('br'),
                                                    `√Çge: ${age} jours ‚Ä¢ ${b.weight}g`
                                                ),
                                                React.createElement('span', { className: `bag-status ${b.status}` }, b.status === 'active' ? '‚úì Actif' : '‚óã Termin√©')
                                            )
                                        ),
                                        React.createElement('div', { style: { display: 'flex', gap: '10px' } },
                                            React.createElement('button', {
                                                className: 'btn btn-secondary btn-small',
                                                onClick: () => toggleBag(b.id, b.status)
                                            }, b.status === 'active' ? 'Terminer' : 'R√©activer'),
                                            React.createElement('button', {
                                                className: 'btn btn-danger btn-small',
                                                onClick: () => delBag(b.id)
                                            }, '‚úï')
                                        )
                                    ),
                                    b.notes && React.createElement('div', { style: { marginTop: '12px', fontSize: '15px', color: '#666', fontStyle: 'italic' } }, 'üìù ' + b.notes)
                                );
                            })
                        )
                    ),

                    tab === 'settings' && React.createElement('div', { className: 'section' },
                        React.createElement('h2', null, '‚öôÔ∏è Param√®tres'),
                        React.createElement('div', { className: 'alert alert-success' }, '‚úÖ Synchronis√© avec Supabase'),
                        React.createElement('h3', { style: { marginTop: '25px', marginBottom: '15px' } }, 'Importer des donn√©es CSV'),
                        React.createElement('div', { className: 'file-input-wrapper' },
                            React.createElement('button', { className: 'btn btn-secondary' }, 'üìÅ Choisir un fichier CSV'),
                            React.createElement('input', { type: 'file', accept: '.csv', onChange: importCSV })
                        ),
                        React.createElement('h3', { style: { marginTop: '30px', marginBottom: '15px' } }, 'Exporter les donn√©es'),
                        React.createElement('p', { style: { marginBottom: '15px', color: '#666' } }, `${shots.length} shots enregistr√©s`),
                        React.createElement('button', {
                            className: 'btn btn-primary',
                            onClick: exportCSV,
                            disabled: shots.length === 0,
                            style: { width: 'auto' }
                        }, 'üì• T√©l√©charger CSV')
                    )
                );
            }

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(App));
        });
    </script>
</body>
</html>
